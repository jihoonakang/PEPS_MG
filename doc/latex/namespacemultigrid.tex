\hypertarget{namespacemultigrid}{}\section{multigrid Module Reference}
\label{namespacemultigrid}\index{multigrid@{multigrid}}


Module for solving Poisson equation with V-\/cycle multigrid(\+M\+G) method.  C\+GS, C\+GA and C\+G\+P\+SA are supported in this module. C\+GS \+: Coarse grid solver without grid aggregation. C\+GA \+: Coarse grid aggregation in a target level. All grid variables are aggregated into a singel core. C\+G\+P\+SA \+: Coarse grid partial semi-\/aggregation in multiple levels.!$>$  


\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public \hyperlink{namespacemultigrid_ac8deb32ba5698e37f75c369dc063b277}{multigrid\+\_\+create} (sdm, nlevel, ncycle, aggr\+\_\+method, single\+\_\+aggr\+\_\+level, adaptive\+\_\+aggr\+\_\+level)
\begin{DoxyCompactList}\small\item\em Create MG subdomains and Poisson matrix  MG subdomain depends on aggregation type. Different subroutines are called according to aggregation type. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{namespacemultigrid_a07ed47be36b2e0df9d71ec58151b642b}\label{namespacemultigrid_a07ed47be36b2e0df9d71ec58151b642b}} 
subroutine, public \hyperlink{namespacemultigrid_a07ed47be36b2e0df9d71ec58151b642b}{multigrid\+\_\+destroy}
\begin{DoxyCompactList}\small\item\em Destroy all variables in all MG subdomains. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacemultigrid_a839d1e13e2d0bac4959deec5669d4171}{multigrid\+\_\+prolongation\+\_\+linear\+\_\+on\+\_\+nonuniform\+\_\+grid} (val\+\_\+f, val\+\_\+c, dm\+\_\+f, dm\+\_\+c, level)
\begin{DoxyCompactList}\small\item\em Prolongation subroutine for C\+GS, C\+GA, and C\+G\+P\+SA  This subroutine is commonly used by using stride\+\_\+f and offest\+\_\+f variables Constant profile in assumed in finer level. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacemultigrid_ad1ba34848f786afdf0e91afb3d3be819}{multigrid\+\_\+residual} (rsd, a\+\_\+poisson, x, rhs, dm, is\+\_\+aggregated)
\begin{DoxyCompactList}\small\item\em Residual calculation. rsd = rhs -\/ a\+\_\+poisson $\ast$ x. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacemultigrid_a7d60c9d01777350a79ff7bd975a90121}{multigrid\+\_\+solve\+\_\+vcycle} (sol, rsd, a\+\_\+poisson, rhs, sdm, maxiteration, tolerance, omega\+\_\+sor)
\begin{DoxyCompactList}\small\item\em V-\/\+Cycle MG solver\+: call subroutines according to aggregation type. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacemultigrid_aa8278baf0276649fe656c1b8f7dba30a}{multigrid\+\_\+cgs\+\_\+vcycle\+\_\+solver} (sol, rsd, a\+\_\+poisson, rhs, sdm, maxiteration, tolerance, omega\+\_\+sor)
\begin{DoxyCompactList}\small\item\em V-\/\+Cycle MG solver with C\+GS. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacemultigrid_a4295ca0af002ede1dee98750922f1f60}{multigrid\+\_\+cga\+\_\+vcycle\+\_\+solver} (sol, rsd, a\+\_\+poisson, rhs, sdm, maxiteration, tolerance, omega\+\_\+sor)
\begin{DoxyCompactList}\small\item\em V-\/\+Cycle MG solver with C\+GA  M\+P\+I\+\_\+\+Gather/\+M\+P\+I\+\_\+\+Scatterv with derived datatypes are used for aggregation. \end{DoxyCompactList}\item 
subroutine \hyperlink{namespacemultigrid_ae89565627880985244634750502edab5}{multigrid\+\_\+cgpsa\+\_\+vcycle\+\_\+solver} (sol, rsd, a\+\_\+poisson, rhs, sdm, maxiteration, tolerance, omega\+\_\+sor)
\begin{DoxyCompactList}\small\item\em V-\/\+Cycle MG solver with C\+G\+P\+SA  M\+P\+I\+\_\+\+Gather/\+M\+P\+I\+\_\+\+Scatterv with derived datatypes are used for aggregation. \end{DoxyCompactList}\end{DoxyCompactItemize}
\textbf{ }\par
\begin{DoxyCompactItemize}
\item 
subroutine \hyperlink{namespacemultigrid_acb52ce247bf637e69274d8da44d1f159}{multigrid\+\_\+subdomain\+\_\+create\+\_\+cgs} (sdm)
\begin{DoxyCompactList}\small\item\em Create MG subdomains for C\+GS  Define MG domain and assign grid dimensions such as mesh size, grid spacing and grid coordinates in each MG levels. \end{DoxyCompactList}\end{DoxyCompactItemize}

\textbf{ }\par
\begin{DoxyCompactItemize}
\item 
subroutine \hyperlink{namespacemultigrid_ae33e2e076cc087e7d149a3150c1ca1af}{multigrid\+\_\+subdomain\+\_\+create\+\_\+cga} (sdm)
\begin{DoxyCompactList}\small\item\em Create MG subdomains for C\+GA  Define MG domain and assign grid dimensions such as mesh size, grid spacing and grid coordinates in each MG levels. \end{DoxyCompactList}\end{DoxyCompactItemize}

\textbf{ }\par
\begin{DoxyCompactItemize}
\item 
subroutine \hyperlink{namespacemultigrid_aa2eb7c900fb5875f844c04c27c552373}{multigrid\+\_\+subdomain\+\_\+create\+\_\+cgpsa} (sdm)
\begin{DoxyCompactList}\small\item\em Create MG subdomains for C\+G\+P\+SA  Define MG domain and assign grid dimensions such as mesh size, grid spacing and grid coordinates in each MG levels. \end{DoxyCompactList}\end{DoxyCompactItemize}



\subsection{Detailed Description}
Module for solving Poisson equation with V-\/cycle multigrid(\+M\+G) method.  C\+GS, C\+GA and C\+G\+P\+SA are supported in this module. C\+GS \+: Coarse grid solver without grid aggregation. C\+GA \+: Coarse grid aggregation in a target level. All grid variables are aggregated into a singel core. C\+G\+P\+SA \+: Coarse grid partial semi-\/aggregation in multiple levels.!$>$ 

\subsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacemultigrid_a4295ca0af002ede1dee98750922f1f60}\label{namespacemultigrid_a4295ca0af002ede1dee98750922f1f60}} 
\index{multigrid@{multigrid}!multigrid\+\_\+cga\+\_\+vcycle\+\_\+solver@{multigrid\+\_\+cga\+\_\+vcycle\+\_\+solver}}
\index{multigrid\+\_\+cga\+\_\+vcycle\+\_\+solver@{multigrid\+\_\+cga\+\_\+vcycle\+\_\+solver}!multigrid@{multigrid}}
\subsubsection{\texorpdfstring{multigrid\+\_\+cga\+\_\+vcycle\+\_\+solver()}{multigrid\_cga\_vcycle\_solver()}}
{\footnotesize\ttfamily subroutine multigrid\+::multigrid\+\_\+cga\+\_\+vcycle\+\_\+solver (\begin{DoxyParamCaption}\item[{real(kind=8), dimension(0\+:,0\+:,0\+:), intent(inout)}]{sol,  }\item[{real(kind=8), dimension(0\+:,0\+:,0\+:), intent(inout)}]{rsd,  }\item[{type(\hyperlink{structmatrix_1_1matrix__heptadiagonal}{matrix\+\_\+heptadiagonal}), intent(in)}]{a\+\_\+poisson,  }\item[{real(kind=8), dimension(0\+:,0\+:,0\+:), intent(in)}]{rhs,  }\item[{type(\hyperlink{structgeometry_1_1subdomain}{subdomain}), intent(in)}]{sdm,  }\item[{integer(kind=4), intent(in)}]{maxiteration,  }\item[{real(kind=8), intent(in)}]{tolerance,  }\item[{real(kind=8), intent(in)}]{omega\+\_\+sor }\end{DoxyParamCaption})}



V-\/\+Cycle MG solver with C\+GA  M\+P\+I\+\_\+\+Gather/\+M\+P\+I\+\_\+\+Scatterv with derived datatypes are used for aggregation. 


\begin{DoxyParams}{Parameters}
{\em sol} & Result solution having a shape of 3D matrix \\
\hline
{\em rsd} & Residual \\
\hline
{\em a\+\_\+poisson} & Heptadiagonal poisson matrix \\
\hline
{\em rhs} & R\+HS vector having a shape of 3D matrix \\
\hline
{\em sdm} & Subdomain \\
\hline
{\em maxiteration} & Maximum number of iterations \\
\hline
{\em tolerance} & Convergence criteria \\
\hline
{\em omega\+\_\+sor} & Relexation factor \\
\hline
\end{DoxyParams}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemultigrid_a4295ca0af002ede1dee98750922f1f60_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=315pt]{namespacemultigrid_a4295ca0af002ede1dee98750922f1f60_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemultigrid_ae89565627880985244634750502edab5}\label{namespacemultigrid_ae89565627880985244634750502edab5}} 
\index{multigrid@{multigrid}!multigrid\+\_\+cgpsa\+\_\+vcycle\+\_\+solver@{multigrid\+\_\+cgpsa\+\_\+vcycle\+\_\+solver}}
\index{multigrid\+\_\+cgpsa\+\_\+vcycle\+\_\+solver@{multigrid\+\_\+cgpsa\+\_\+vcycle\+\_\+solver}!multigrid@{multigrid}}
\subsubsection{\texorpdfstring{multigrid\+\_\+cgpsa\+\_\+vcycle\+\_\+solver()}{multigrid\_cgpsa\_vcycle\_solver()}}
{\footnotesize\ttfamily subroutine multigrid\+::multigrid\+\_\+cgpsa\+\_\+vcycle\+\_\+solver (\begin{DoxyParamCaption}\item[{real(kind=8), dimension(0\+:,0\+:,0\+:), intent(inout)}]{sol,  }\item[{real(kind=8), dimension(0\+:,0\+:,0\+:), intent(inout)}]{rsd,  }\item[{type(\hyperlink{structmatrix_1_1matrix__heptadiagonal}{matrix\+\_\+heptadiagonal}), intent(in)}]{a\+\_\+poisson,  }\item[{real(kind=8), dimension(0\+:,0\+:,0\+:), intent(in)}]{rhs,  }\item[{type(\hyperlink{structgeometry_1_1subdomain}{subdomain}), intent(in)}]{sdm,  }\item[{integer(kind=4), intent(in)}]{maxiteration,  }\item[{real(kind=8), intent(in)}]{tolerance,  }\item[{real(kind=8), intent(in)}]{omega\+\_\+sor }\end{DoxyParamCaption})}



V-\/\+Cycle MG solver with C\+G\+P\+SA  M\+P\+I\+\_\+\+Gather/\+M\+P\+I\+\_\+\+Scatterv with derived datatypes are used for aggregation. 


\begin{DoxyParams}{Parameters}
{\em sol} & Result solution having a shape of 3D matrix \\
\hline
{\em rsd} & Residual \\
\hline
{\em a\+\_\+poisson} & Heptadiagonal poisson matrix \\
\hline
{\em rhs} & R\+HS vector having a shape of 3D matrix \\
\hline
{\em sdm} & Subdomain \\
\hline
{\em maxiteration} & Maximum number of iterations \\
\hline
{\em tolerance} & Convergence criteria \\
\hline
{\em omega\+\_\+sor} & Relexation factor \\
\hline
\end{DoxyParams}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemultigrid_ae89565627880985244634750502edab5_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=325pt]{namespacemultigrid_ae89565627880985244634750502edab5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemultigrid_aa8278baf0276649fe656c1b8f7dba30a}\label{namespacemultigrid_aa8278baf0276649fe656c1b8f7dba30a}} 
\index{multigrid@{multigrid}!multigrid\+\_\+cgs\+\_\+vcycle\+\_\+solver@{multigrid\+\_\+cgs\+\_\+vcycle\+\_\+solver}}
\index{multigrid\+\_\+cgs\+\_\+vcycle\+\_\+solver@{multigrid\+\_\+cgs\+\_\+vcycle\+\_\+solver}!multigrid@{multigrid}}
\subsubsection{\texorpdfstring{multigrid\+\_\+cgs\+\_\+vcycle\+\_\+solver()}{multigrid\_cgs\_vcycle\_solver()}}
{\footnotesize\ttfamily subroutine multigrid\+::multigrid\+\_\+cgs\+\_\+vcycle\+\_\+solver (\begin{DoxyParamCaption}\item[{real(kind=8), dimension(0\+:,0\+:,0\+:), intent(inout)}]{sol,  }\item[{real(kind=8), dimension(0\+:,0\+:,0\+:), intent(inout)}]{rsd,  }\item[{type(\hyperlink{structmatrix_1_1matrix__heptadiagonal}{matrix\+\_\+heptadiagonal}), intent(in)}]{a\+\_\+poisson,  }\item[{real(kind=8), dimension(0\+:,0\+:,0\+:), intent(in)}]{rhs,  }\item[{type(\hyperlink{structgeometry_1_1subdomain}{subdomain}), intent(in)}]{sdm,  }\item[{integer(kind=4), intent(in)}]{maxiteration,  }\item[{real(kind=8), intent(in)}]{tolerance,  }\item[{real(kind=8), intent(in)}]{omega\+\_\+sor }\end{DoxyParamCaption})}



V-\/\+Cycle MG solver with C\+GS. 


\begin{DoxyParams}{Parameters}
{\em sol} & Result solution having a shape of 3D matrix \\
\hline
{\em rsd} & Residual \\
\hline
{\em a\+\_\+poisson} & Heptadiagonal poisson matrix \\
\hline
{\em rhs} & R\+HS vector having a shape of 3D matrix \\
\hline
{\em sdm} & Subdomain \\
\hline
{\em maxiteration} & Maximum number of iterations \\
\hline
{\em tolerance} & Convergence criteria \\
\hline
{\em omega\+\_\+sor} & Relexation factor \\
\hline
\end{DoxyParams}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemultigrid_aa8278baf0276649fe656c1b8f7dba30a_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=315pt]{namespacemultigrid_aa8278baf0276649fe656c1b8f7dba30a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemultigrid_ac8deb32ba5698e37f75c369dc063b277}\label{namespacemultigrid_ac8deb32ba5698e37f75c369dc063b277}} 
\index{multigrid@{multigrid}!multigrid\+\_\+create@{multigrid\+\_\+create}}
\index{multigrid\+\_\+create@{multigrid\+\_\+create}!multigrid@{multigrid}}
\subsubsection{\texorpdfstring{multigrid\+\_\+create()}{multigrid\_create()}}
{\footnotesize\ttfamily subroutine, public multigrid\+::multigrid\+\_\+create (\begin{DoxyParamCaption}\item[{type(\hyperlink{structgeometry_1_1subdomain}{subdomain}), intent(in)}]{sdm,  }\item[{integer(kind=4), intent(in)}]{nlevel,  }\item[{integer(kind=4), intent(in)}]{ncycle,  }\item[{integer(kind=4), intent(in)}]{aggr\+\_\+method,  }\item[{integer(kind=4), intent(in)}]{single\+\_\+aggr\+\_\+level,  }\item[{integer(kind=4), dimension(3), intent(in)}]{adaptive\+\_\+aggr\+\_\+level }\end{DoxyParamCaption})}



Create MG subdomains and Poisson matrix  MG subdomain depends on aggregation type. Different subroutines are called according to aggregation type. 


\begin{DoxyParams}{Parameters}
{\em sdm} & Subdomain \\
\hline
{\em nlevel} & Number of MG level \\
\hline
{\em ncycle} & Number of V-\/cycle \\
\hline
{\em aggr\+\_\+method} & Aggregation method, 0\+: C\+GS, 1\+: C\+GA, 2\+: C\+G\+P\+SA \\
\hline
{\em single\+\_\+aggr\+\_\+level} & Aggregation level for C\+GA \\
\hline
{\em adaptive\+\_\+aggr\+\_\+level} & Aggregation levels in x-\/, y-\/, and z-\/directions for C\+G\+P\+SA \\
\hline
\end{DoxyParams}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemultigrid_ac8deb32ba5698e37f75c369dc063b277_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemultigrid_a839d1e13e2d0bac4959deec5669d4171}\label{namespacemultigrid_a839d1e13e2d0bac4959deec5669d4171}} 
\index{multigrid@{multigrid}!multigrid\+\_\+prolongation\+\_\+linear\+\_\+on\+\_\+nonuniform\+\_\+grid@{multigrid\+\_\+prolongation\+\_\+linear\+\_\+on\+\_\+nonuniform\+\_\+grid}}
\index{multigrid\+\_\+prolongation\+\_\+linear\+\_\+on\+\_\+nonuniform\+\_\+grid@{multigrid\+\_\+prolongation\+\_\+linear\+\_\+on\+\_\+nonuniform\+\_\+grid}!multigrid@{multigrid}}
\subsubsection{\texorpdfstring{multigrid\+\_\+prolongation\+\_\+linear\+\_\+on\+\_\+nonuniform\+\_\+grid()}{multigrid\_prolongation\_linear\_on\_nonuniform\_grid()}}
{\footnotesize\ttfamily subroutine multigrid\+::multigrid\+\_\+prolongation\+\_\+linear\+\_\+on\+\_\+nonuniform\+\_\+grid (\begin{DoxyParamCaption}\item[{real(kind=8), dimension(0\+:,0\+:,0\+:), intent(out)}]{val\+\_\+f,  }\item[{real(kind=8), dimension(0\+:,0\+:,0\+:), intent(in)}]{val\+\_\+c,  }\item[{type(\hyperlink{structgeometry_1_1subdomain}{subdomain}), intent(in)}]{dm\+\_\+f,  }\item[{type(\hyperlink{structgeometry_1_1subdomain}{subdomain}), intent(in)}]{dm\+\_\+c,  }\item[{integer(kind=4), intent(in)}]{level }\end{DoxyParamCaption})}



Prolongation subroutine for C\+GS, C\+GA, and C\+G\+P\+SA  This subroutine is commonly used by using stride\+\_\+f and offest\+\_\+f variables Constant profile in assumed in finer level. 


\begin{DoxyParams}{Parameters}
{\em val\+\_\+f} & Variable in finer grid \\
\hline
{\em val\+\_\+c} & Variable in coarser grid \\
\hline
{\em dm\+\_\+f} & MG subdomain in finer level \\
\hline
{\em dm\+\_\+c} & MG subdomain in coarser level \\
\hline
{\em level} & MG level where restriction is conducted \\
\hline
\end{DoxyParams}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemultigrid_a839d1e13e2d0bac4959deec5669d4171_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemultigrid_a839d1e13e2d0bac4959deec5669d4171_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemultigrid_ad1ba34848f786afdf0e91afb3d3be819}\label{namespacemultigrid_ad1ba34848f786afdf0e91afb3d3be819}} 
\index{multigrid@{multigrid}!multigrid\+\_\+residual@{multigrid\+\_\+residual}}
\index{multigrid\+\_\+residual@{multigrid\+\_\+residual}!multigrid@{multigrid}}
\subsubsection{\texorpdfstring{multigrid\+\_\+residual()}{multigrid\_residual()}}
{\footnotesize\ttfamily subroutine multigrid\+::multigrid\+\_\+residual (\begin{DoxyParamCaption}\item[{real(kind=8), dimension(0\+:,0\+:,0\+:), intent(out)}]{rsd,  }\item[{type(\hyperlink{structmatrix_1_1matrix__heptadiagonal}{matrix\+\_\+heptadiagonal}), intent(in)}]{a\+\_\+poisson,  }\item[{real(kind=8), dimension(0\+:,0\+:,0\+:), intent(inout)}]{x,  }\item[{real(kind=8), dimension(0\+:,0\+:,0\+:), intent(in)}]{rhs,  }\item[{type(\hyperlink{structgeometry_1_1subdomain}{subdomain}), intent(in)}]{dm,  }\item[{logical, dimension(0\+:2), intent(in)}]{is\+\_\+aggregated }\end{DoxyParamCaption})}



Residual calculation. rsd = rhs -\/ a\+\_\+poisson $\ast$ x. 


\begin{DoxyParams}{Parameters}
{\em rsd} & Residual \\
\hline
{\em a\+\_\+poisson} & A matrix \\
\hline
{\em x} & x vector \\
\hline
{\em rhs} & R\+HS \\
\hline
{\em dm} & MG subdomain in target level \\
\hline
{\em is\+\_\+aggregated} & Aggregation information on whether domain is aggregated (.true.) or not (.false.) \\
\hline
\end{DoxyParams}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemultigrid_ad1ba34848f786afdf0e91afb3d3be819_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemultigrid_ad1ba34848f786afdf0e91afb3d3be819_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemultigrid_a7d60c9d01777350a79ff7bd975a90121}\label{namespacemultigrid_a7d60c9d01777350a79ff7bd975a90121}} 
\index{multigrid@{multigrid}!multigrid\+\_\+solve\+\_\+vcycle@{multigrid\+\_\+solve\+\_\+vcycle}}
\index{multigrid\+\_\+solve\+\_\+vcycle@{multigrid\+\_\+solve\+\_\+vcycle}!multigrid@{multigrid}}
\subsubsection{\texorpdfstring{multigrid\+\_\+solve\+\_\+vcycle()}{multigrid\_solve\_vcycle()}}
{\footnotesize\ttfamily subroutine, public multigrid\+::multigrid\+\_\+solve\+\_\+vcycle (\begin{DoxyParamCaption}\item[{real(kind=8), dimension(0\+:,0\+:,0\+:), intent(inout)}]{sol,  }\item[{real(kind=8), dimension(0\+:,0\+:,0\+:), intent(inout)}]{rsd,  }\item[{type(\hyperlink{structmatrix_1_1matrix__heptadiagonal}{matrix\+\_\+heptadiagonal}), intent(in)}]{a\+\_\+poisson,  }\item[{real(kind=8), dimension(0\+:,0\+:,0\+:), intent(in)}]{rhs,  }\item[{type(\hyperlink{structgeometry_1_1subdomain}{subdomain}), intent(in)}]{sdm,  }\item[{integer(kind=4), intent(in)}]{maxiteration,  }\item[{real(kind=8), intent(in)}]{tolerance,  }\item[{real(kind=8), intent(in)}]{omega\+\_\+sor }\end{DoxyParamCaption})}



V-\/\+Cycle MG solver\+: call subroutines according to aggregation type. 


\begin{DoxyParams}{Parameters}
{\em sol} & Result solution having a shape of 3D matrix \\
\hline
{\em rsd} & Residual \\
\hline
{\em a\+\_\+poisson} & Heptadiagonal poisson matrix \\
\hline
{\em rhs} & R\+HS vector having a shape of 3D matrix \\
\hline
{\em sdm} & Subdomain \\
\hline
{\em maxiteration} & Maximum number of iterations \\
\hline
{\em tolerance} & Convergence criteria \\
\hline
{\em omega\+\_\+sor} & Relexation factor \\
\hline
\end{DoxyParams}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemultigrid_a7d60c9d01777350a79ff7bd975a90121_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemultigrid_ae33e2e076cc087e7d149a3150c1ca1af}\label{namespacemultigrid_ae33e2e076cc087e7d149a3150c1ca1af}} 
\index{multigrid@{multigrid}!multigrid\+\_\+subdomain\+\_\+create\+\_\+cga@{multigrid\+\_\+subdomain\+\_\+create\+\_\+cga}}
\index{multigrid\+\_\+subdomain\+\_\+create\+\_\+cga@{multigrid\+\_\+subdomain\+\_\+create\+\_\+cga}!multigrid@{multigrid}}
\subsubsection{\texorpdfstring{multigrid\+\_\+subdomain\+\_\+create\+\_\+cga()}{multigrid\_subdomain\_create\_cga()}}
{\footnotesize\ttfamily subroutine multigrid\+::multigrid\+\_\+subdomain\+\_\+create\+\_\+cga (\begin{DoxyParamCaption}\item[{type(\hyperlink{structgeometry_1_1subdomain}{subdomain}), intent(in), target}]{sdm }\end{DoxyParamCaption})}



Create MG subdomains for C\+GA  Define MG domain and assign grid dimensions such as mesh size, grid spacing and grid coordinates in each MG levels. 


\begin{DoxyParams}{Parameters}
{\em sdm} & Subdomain \\
\hline
\end{DoxyParams}
Number of grid in aggregation levels, nx $\ast$ number of M\+PI processes

Pointer for mesh size in current MG level

Pointer for grid spacing in current MG level

Pointer for grid coordinates in current MG levelHere is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=334pt]{namespacemultigrid_ae33e2e076cc087e7d149a3150c1ca1af_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemultigrid_aa2eb7c900fb5875f844c04c27c552373}\label{namespacemultigrid_aa2eb7c900fb5875f844c04c27c552373}} 
\index{multigrid@{multigrid}!multigrid\+\_\+subdomain\+\_\+create\+\_\+cgpsa@{multigrid\+\_\+subdomain\+\_\+create\+\_\+cgpsa}}
\index{multigrid\+\_\+subdomain\+\_\+create\+\_\+cgpsa@{multigrid\+\_\+subdomain\+\_\+create\+\_\+cgpsa}!multigrid@{multigrid}}
\subsubsection{\texorpdfstring{multigrid\+\_\+subdomain\+\_\+create\+\_\+cgpsa()}{multigrid\_subdomain\_create\_cgpsa()}}
{\footnotesize\ttfamily subroutine multigrid\+::multigrid\+\_\+subdomain\+\_\+create\+\_\+cgpsa (\begin{DoxyParamCaption}\item[{type(\hyperlink{structgeometry_1_1subdomain}{subdomain}), intent(in), target}]{sdm }\end{DoxyParamCaption})}



Create MG subdomains for C\+G\+P\+SA  Define MG domain and assign grid dimensions such as mesh size, grid spacing and grid coordinates in each MG levels. 


\begin{DoxyParams}{Parameters}
{\em sdm} & Subdomain \\
\hline
\end{DoxyParams}
Number of grid in aggregation levels, nx $\ast$ number of M\+PI processes

Pointer for mesh size in current MG level

Pointer for grid spacing in current MG level

Pointer for grid coordinates in current MG levelHere is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=345pt]{namespacemultigrid_aa2eb7c900fb5875f844c04c27c552373_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemultigrid_acb52ce247bf637e69274d8da44d1f159}\label{namespacemultigrid_acb52ce247bf637e69274d8da44d1f159}} 
\index{multigrid@{multigrid}!multigrid\+\_\+subdomain\+\_\+create\+\_\+cgs@{multigrid\+\_\+subdomain\+\_\+create\+\_\+cgs}}
\index{multigrid\+\_\+subdomain\+\_\+create\+\_\+cgs@{multigrid\+\_\+subdomain\+\_\+create\+\_\+cgs}!multigrid@{multigrid}}
\subsubsection{\texorpdfstring{multigrid\+\_\+subdomain\+\_\+create\+\_\+cgs()}{multigrid\_subdomain\_create\_cgs()}}
{\footnotesize\ttfamily subroutine multigrid\+::multigrid\+\_\+subdomain\+\_\+create\+\_\+cgs (\begin{DoxyParamCaption}\item[{type(\hyperlink{structgeometry_1_1subdomain}{subdomain}), intent(in), target}]{sdm }\end{DoxyParamCaption})}



Create MG subdomains for C\+GS  Define MG domain and assign grid dimensions such as mesh size, grid spacing and grid coordinates in each MG levels. 


\begin{DoxyParams}{Parameters}
{\em sdm} & Subdomain \\
\hline
\end{DoxyParams}
Pointer for mesh size in current MG level

Pointer for grid spacing in current MG level

Pointer for grid coordinates in current MG levelHere is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=334pt]{namespacemultigrid_acb52ce247bf637e69274d8da44d1f159_icgraph}
\end{center}
\end{figure}
